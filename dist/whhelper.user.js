// ==UserScript==
// @name         WykopHelper
// @version      0.52
// @updateURL    https://cdn.jsdelivr.net/gh/plwpl/WykopHelper/dist/whhelper.user.js
// @downloadURL  https://cdn.jsdelivr.net/gh/plwpl/WykopHelper/dist/whhelper.user.js
// @description  Zestaw narzędzi pomocnych na wykopie. Pełna, niezminifikowana wersja kodu dostępna na githubie - PLWpl/WykopHelper
// @author       PLW
// @match        https://www.wykop.pl/*
// @require      https://cdn.jsdelivr.net/npm/sweetalert2@10
// @grant        none
// ==/UserScript==
!function(){"use strict";const e=location.href,t=()=>!!(e.indexOf("wykop.pl")>-1),n=()=>e.indexOf("wykop.pl/link/")>-1||e.indexOf("wykop.pl/mikroblog/")>-1||e.indexOf("wykop.pl/wpis/")>-1||e.indexOf("wykop.pl/moj/")>-1||e.indexOf("wykop.pl/ludzie/")>-1||e.indexOf("wykop.pl/tag/")>-1,a=()=>!!(e.indexOf("wykop.pl/ustawienia/")>-1),o=()=>!!(e.indexOf("wykop.pl/ustawienia/wykophelper")>-1),i=()=>!!(e.indexOf("wykop.pl/link/")>-1),l=()=>!!(e.indexOf("wykop.pl/wpis/")>-1),r=(e,t=document)=>t.querySelector(e),s=(e,t=document)=>t.querySelectorAll(e),E="whMarkedUsers",A="whUniqueNicks",c="whSettings",S={COMMON:{CLASSNAME:{WOODLE:"woodle",BUTTON:"buttonWH"}},BADGE:{CLASSNAME:{NICK_ELEMENT:"author",NICK_VERIFIED_BADGE:"verified",NICK:"showProfileSummary",VOTES_USERCARD:"usercard",BADGE:"badgeWH",MARK_BUTTON:"buttonWH",MARK_BUTTON_CLICKED:"buttonWH--clicked",MARK_ALL_BUTTON_ELEMENT:"buttonWH--markAllContainer",MARK_ALL_BUTTON:"buttonWH--markAll",MODAL_BUTTON:"modalWH-button",MODAL_BUTTON_REMOVE:"modalWH-button--remove",MODAL_TEXT:"modalWH-text"},ID:{VOTES_CONTAINER:"votesContainer"},SELECTOR:{NICK_ELEMENTS:".grid-main li div.author",NICK:".showProfileSummary > b",NICK_DELETED:".author > .color-1002",REPLY_FORM:".replyForm textarea",COMMENT_FORM:"#commentFormContainer textarea"},DYNAMIC:{DATASET:{USERNAME:e=>"[data-whusername='"+e}}},SETTINGS:{CLASSNAME:{SETTINGS_NAV:"whSettingsLink",SETTINGS_GENERAL:"settings--general",SETTINGS_BADGE:"settings--badge",SETTINGS_SPECIAL:"settings--special",WH_NAV_SETTINGS_LINK:"whSettingsLink",WH_USER_TABLE:"tableWH",WH_USER_TABLE_ROW:"tableWH__row",WH_USER_TABLE_HEAD:"tableWH__head",WH_USER_TABLE_HEADING:"tableWH__heading",WH_USER_TABLE_CONTAINER:"tableWH__container",WH_USER_TABLE_CONTAINER_HIDDEN:"tableWH__container--hidden",WH_USER_TABLE_BODY:"tableWH__body",WH_USER_TABLE_REMOVE_BUTTON:"tableWH__nick-remove",WH_SETTINGS_CROSSED:"settings__crossed"},ID:{SHOW_MARKED_TABLE:"showAllMarked",ALLOW_WIPE_MARKED_LIST:"allowWipeAllMarked",REMOVE_ALL_MARKED:"whsettings__remove-all-marked",RUSSIAN_PROPAGANDA_INFO_LINK:"russianPropagandaInfo",WARN_ON_RELOAD_INFO_LINK:"warnOnReloadInfo"},SELECTOR:{LAST_NAV_ELEMENT:"#site .nav > ul > li:last-child",ACTIVE_NAV_ELEMENT:"#site .nav > ul .active",SETTINGS_FORM_ELEMENT:"#site .grid-main .settings"},DYNAMIC:{}},HIGHLIGHT_OP:{CLASSNAME:{HIGHLIGHT_BUTTON:"button--highlightOp",AUTHOR_COMMENTS:"authorComment"},ID:{},SELECTOR:{OP_THREAD:'[data-type="entry"]'},DYNAMIC:{}},EMBED:{CLASSNAME:{EMBED_FILE:"embedFile"},ID:{},SELECTOR:{},DYNAMIC:{}},DOMAIN_CHECKER:{CLASSNAME:{WYKOP_ITEM_INTRO:"bspace",WYKOP_ITEM_ANNOTATION:"annotation"},ID:{},SELECTOR:{THREAD_LINK:".article h2 a"},DYNAMIC:{}},MODAL:{CLASSNAME:{LINK:"whModalLink",LIST:"whModal__list",LIST_ITEM:"whModal__list-item",INPUT_LABEL:"whModal__label",INPUT_TEXT:"whModal__inputText",SCROLLABLE_TEXT:"whModal__scrollableText"},ID:{BADGE_TEXT:"whModal_badgeText"}}},d={badge:`\n.${S.BADGE.CLASSNAME.MARK_BUTTON} {\n  display: inline-block;\n  padding: .2rem .2rem;\n  border: 1px solid #9999996e;\n  cursor: pointer;\n  margin-left: .5rem;\n  color: #808080ba;\n  border-radius: .3rem;\n  font-size: .7rem;\n  line-height: .7rem;\n  transition: .3s all;\n}\n.${S.BADGE.CLASSNAME.MARK_BUTTON}:hover {\n  border-color: green;\n}\n.${S.BADGE.CLASSNAME.MARK_BUTTON_CLICKED} {\n  border-color: green;\n  opacity: 0;\n}\n.${S.BADGE.CLASSNAME.BADGE} {\n  color: red;\n  font-weight: bold;\n  margin-right: .3rem;\n  border: 1px solid currentColor;\n  padding: .1rem .2rem;\n  cursor: pointer;\n  position: relative;\n  top: .1rem;\n}\n.${S.BADGE.CLASSNAME.MODAL_BUTTON} {\n  display: block;\n  padding: .4rem .8rem;\n  border: 1px solid #9999996e;\n  cursor: pointer;\n  color: #808080ba;\n  border-radius: .3rem;\n  font-size: 1rem;\n  line-height: 1rem;\n  transition: .3s all;\n}\n.author .${S.BADGE.CLASSNAME.MODAL_TEXT} {\n  position: relative;\n  margin-bottom: .5rem;\n  top: unset;\n  right: unset;\n  left: unset;\n  bottom: unset;\n}\n\n.${S.BADGE.CLASSNAME.MARK_ALL_BUTTON} {\n  top: 0.8rem;\n  position: relative;\n}\n\n.${S.HIGHLIGHT_OP.CLASSNAME.HIGHLIGHT_BUTTON} {\n  position: absolute;\n  top: .1rem;\n  left: 0;\n}\n\n@media screen and (min-width: 722px) {\n  .${S.HIGHLIGHT_OP.CLASSNAME.HIGHLIGHT_BUTTON} {\n    top: 6rem;\n    left: 1rem;\n  }\n}\n\n.${S.DOMAIN_CHECKER.CLASSNAME.MODAL_TEXT_LIST} {\n  margin-top:1rem;list-style-type: circle;font-size:1rem;\n}\n\n.${S.DOMAIN_CHECKER.CLASSNAME.MODAL_TEXT_LIST_ITEM} {\n  text-align:left;margin-left:2rem;margin-bottom:.7rem\n}\n`,settings:`\n.${S.SETTINGS.CLASSNAME.WH_USER_TABLE_CONTAINER} {\n  padding: 1rem;\n}\n.${S.SETTINGS.CLASSNAME.WH_USER_TABLE_CONTAINER_HIDDEN} {\n  display: none;\n}\n.${S.SETTINGS.CLASSNAME.WH_USER_TABLE} {\n  counter-reset: row-num;\n}\n.${S.SETTINGS.CLASSNAME.WH_USER_TABLE} .${S.SETTINGS.CLASSNAME.WH_USER_TABLE_ROW} {\n  counter-increment: row-num;\n}\n.${S.SETTINGS.CLASSNAME.WH_USER_TABLE} .${S.SETTINGS.CLASSNAME.WH_USER_TABLE_ROW} td:first-child::before {\n  content: counter(row-num) ". ";\n}\n.${S.SETTINGS.CLASSNAME.WH_USER_TABLE_HEAD} {\n  font-weight: bold;\n  border-bottom: 2px solid currentColor;\n}\n.${S.SETTINGS.CLASSNAME.WH_SETTINGS_CROSSED} {\n  opacity: .4;\n  text-decoration: line-through;\n  cursor: not-allowed;\n}\n.${S.SETTINGS.CLASSNAME.WH_USER_TABLE_REMOVE_BUTTON} {\n  cursor: pointer;\n  color: #c0392b;\n}\n.${S.MODAL.CLASSNAME.LINK} {\n  color: #862828;\n}\n.${S.MODAL.CLASSNAME.LINK}:hover {\n  color: #4a1313 !important;\n}`,modal:`\n.swal2-popup.swal2-modal.swal2-show {\n  background-color: #1b1b1b !important;\n  border: 1px solid #ff5917 !important;\n}\n.swal2-icon.swal2-info {\n  border-color: #542621 !important;\n  color: #c0392b !important;\n}\n\n.swal2-title {\n  color: #a2a2a2 !important;\n}\n\n.swal2-content {\n  color: #888;\n  text-align: unset;\n}\n\n.swal2-styled.swal2-confirm {\n  background-color: #e74c3c6b !important;\n}\n.${S.MODAL.CLASSNAME.LIST} {\n  margin-top: 1rem;\n  list-style-type: square;\n}\n.${S.MODAL.CLASSNAME.LIST_ITEM} {\n  text-align: left;\n  margin-left: 2rem;\n  margin-bottom: .7rem\n}\n\n.${S.MODAL.CLASSNAME.INPUT_LABEL} {\n  text-transform: none;\n}\n\n.${S.MODAL.CLASSNAME.INPUT_TEXT} {\n  color: #464646;\n}\n\n.${S.MODAL.CLASSNAME.SCROLLABLE_TEXT} {\n  margin-top:.5rem;\n  border:1px solid gray;\n  padding: 1rem;\n  text-align:left;\n  overflow: scroll;\n  max-height: 15rem;\n}\n`},L=`<span class="${S.BADGE.CLASSNAME.MARK_BUTTON}">Oznacz</span>`,_=`<li class="${S.BADGE.CLASSNAME.MARK_ALL_BUTTON_ELEMENT}" style="display:none"><span class="${S.BADGE.CLASSNAME.MARK_BUTTON} ${S.BADGE.CLASSNAME.MARK_ALL_BUTTON}">Oznacz wszystkich poniżej</span></li>`,T=(e,t="debil")=>`<span class="${S.BADGE.CLASSNAME.BADGE} ${S.BADGE.CLASSNAME.BADGE}--${t.toLowerCase()}" data-whusername="${e}">${t.toLowerCase().capitalize()}</span>`,N=`\n  <p>Strony oznaczone jako potencjalnie szerzące rosyjską propagandę na wykopie zostały wyznaczone na podstawie następujących źródeł:\n  <ul class="${S.MODAL.CLASSNAME.LIST}">\n    <li class="${S.MODAL.CLASSNAME.LIST_ITEM}"><a class="${S.MODAL.CLASSNAME.LINK}" href="https://www.politicalcapital.hu/wp-content/uploads/PC_reactionary_values_CEE_20160727.pdf" target="_blank">Raport "The Weaponization of Culture: Kremlin's traditional agenda and the export of values to Central Europe" [PDF]</a></li>\n    <li class="${S.MODAL.CLASSNAME.LIST_ITEM}"><a class="${S.MODAL.CLASSNAME.LINK}" href="https://jagiellonia.org/mysl-polska-kresy-pl-geopolityka-org-etc-sa-kanalami-szerzenia-rosyjskich-wplywow-w-polsce-opublikowano-korespondencje-kremlowskich-urzednikow-rappoport-leaks/" target="_blank">Artykuł z Jagiellonia.org</a></li>\n    <li class="${S.MODAL.CLASSNAME.LIST_ITEM}"><a class="${S.MODAL.CLASSNAME.LINK}" href="https://euvsdisinfo.eu/reading-list/" target="_blank">EUvsDiSiNFO</a></li>\n    <li class="${S.MODAL.CLASSNAME.LIST_ITEM}"><a class="${S.MODAL.CLASSNAME.LINK}" href="https://oko.press/rosyjska-propagande-szerza-polskie-portale-znalezlismy-23-takie-witryny/" target="_blank">Artykuł z OKO.Press</a></li>\n  </ul>\n  <p>Lista z czasem będzie uzupełniana, a jedna z aktualizacji już wkrótce przyniesie możliwość przejrzenia (najpierw) i edycji (późniejsza aktualizacja) listy witryn.\n`,p=(e,t="")=>{const n=`<style ${t?'id="'+t+'"':""}> ${e} </style>`;document.body.insertAdjacentHTML("afterbegin",n)},M={BADGE:{HIDE_MARKED_USERS:!1,DEFAULT_NAME:"Debil",DEFAULT_COLOR:"red"},GENERAL:{WARN_ON_RELOAD:!1,WARN_ON_SUSPECTED_RUSSIAN_PROPAGANDA:!0}},m=[],O=[],I=()=>{localStorage.getItem(c)||localStorage.setItem(c,JSON.stringify(M))},u=(e="marked")=>{switch(e){case"settings":return I(),JSON.parse(localStorage.getItem(c));case"unique":return localStorage.getItem(A)||localStorage.setItem(A,JSON.stringify(m)),JSON.parse(localStorage.getItem(A));case"marked":return localStorage.getItem(E)||localStorage.setItem(E,JSON.stringify(O)),JSON.parse(localStorage.getItem(E));default:throw new Error(`Unknown storage type: ${e}. Pick either "unique", "marked" or "settings"`)}},{BADGE:g}=S,w=()=>{let e=u("unique"),t=u("marked"),n=u("settings");const a=t=>(e=u("unique"),!!e.includes(t)),o=(o,i,l="",r="",s=n.BADGE.DEFAULT_NAME)=>{a(o)||((t=>{const n=[...e,t];localStorage.setItem(A,JSON.stringify(n))})(o),((e,n,a,o,i)=>{t=u("marked");const l=[...t,{nick:e,link:n,label:a,content:o,media:i}];localStorage.setItem(E,JSON.stringify(l))})(o,i,s,l,r))},i=()=>s(g.SELECTOR.NICK_ELEMENTS),l=e=>{if(!(r(g.SELECTOR.NICK,e)&&null!==r(g.SELECTOR.NICK,e)||r(g.SELECTOR.NICK_DELETED,e)&&null!==r(g.SELECTOR.NICK_DELETED,e)))throw new Error("getNick didn't work for "+e);return null!==r(g.SELECTOR.NICK,e)?r(g.SELECTOR.NICK,e).innerText:null!==r(g.SELECTOR.NICK_DELETED,e)?r(g.SELECTOR.NICK_DELETED,e).innerText:void 0},c=e=>!r("."+g.CLASSNAME.BADGE,e),N=()=>{try{i().forEach(e=>{const t=l(e),o=m(t)?m(t):null,i=o?o.label:n.BADGE.DEFAULT_NAME;a(t)&&c(e)?e.insertAdjacentHTML("afterbegin",T(t,i)):(e=>!!r("."+g.CLASSNAME.MARK_BUTTON,e))(e)||e.insertAdjacentHTML("beforeend",L)})}catch(e){}},M=()=>{t=u("marked"),N();i().forEach(e=>{const t=l(e);a(t)&&c(e)&&e.insertAdjacentHTML("afterbegin",T(t)),a(t)&&r("."+g.CLASSNAME.MARK_BUTTON,e)&&!r("."+g.CLASSNAME.MARK_BUTTON_CLICKED,e)&&r("."+g.CLASSNAME.MARK_BUTTON,e).remove(),a(t)||c(e)||r("."+g.CLASSNAME.BADGE,e).remove()})},m=e=>{if(!e)throw new Error("getNickData requires nick to be provided.");for(let n=0;n<t.length;n++){if(t[n].nick===e)return{link:t[n].link,nick:t[n].nick,label:t[n].label,content:t[n].content,media:t[n].media};void 0!==t[n]&&t[n]}},O=n=>{const a=r(n).dataset.whusername,o=m(a),i={title:""+(l=o).nick,content:`\n    <p style="text-align:left">Przyczyna oznaczenia</strong>:</p>\n    <div class="${S.MODAL.CLASSNAME.SCROLLABLE_TEXT}"><p>${l.content}</p>\n    ${l.media?(s=l.media,`<p style="margin-top:5px;"><a href="${s}" target="_blank">Link do osadzonej treści multimedialnej (obrazek lub film)</a></p>`):""}</div>\n    <p style="margin-top:1rem;text-align:right"><a href="${l.link}">Link do komentarza lub znaleziska</a></p>\n    <label class="${S.MODAL.CLASSNAME.INPUT_LABEL}">Treść odznaki: <input autocomplete="off" value="${l.label}" class="${S.MODAL.CLASSNAME.INPUT_TEXT}" id="${S.MODAL.ID.BADGE_TEXT}"></label>\n    `,button:"Usuń oznaczenie",buttonClose:"Zapisz"};var l,s;Swal.fire({title:i.title,html:i.content,icon:"info",showCancelButton:!1,showDenyButton:!0,confirmButtonText:i.button,denyButtonText:"Zapisz",width:"80%"}).then(n=>{if(n.isConfirmed)console.log("removing"),(n=>{for(let[e,a]of t.entries())if(a.nick===n){delete t[e];const n=t.filter(e=>null!=e);localStorage.setItem(E,JSON.stringify(n))}const a=e.filter(e=>e!==n);localStorage.setItem(A,JSON.stringify(a)),setTimeout(()=>{M()},780)})(a),Swal.fire("Usunięto!","Użytkownik nie będzie już więcej oznaczany.","info");else if(n.isDenied){console.log("saving...");const e=r("#"+S.MODAL.ID.BADGE_TEXT).value;console.log(e),((e,n,a)=>{for(let o of t.entries())if(o.nick===e){console.log("ls: nick "+e),console.log("ls: prop "+n),console.log("ls: item.prop "+o.prop),console.log("ls: val "+a),o[n]=a,console.log(o[n]);const i=t.filter(e=>null!=e);localStorage.setItem(E,JSON.stringify(i))}})(a,"label",e)}else console.log("sth else xd")})};p(d.badge),p(d.modal),N(),(()=>{if(document.getElementById(g.ID.VOTES_CONTAINER)){const e=document.getElementById(g.ID.VOTES_CONTAINER).closest(".rbl-block").querySelector(".nav ul + ul");e&&e.insertAdjacentHTML("beforeend",_)}})(),document.getElementById("itemsStream").addEventListener("click",e=>{const t=e.target;if(t.classList.contains(g.CLASSNAME.MARK_BUTTON)&&(e=>{const t=l(e.target.closest("."+g.CLASSNAME.NICK_ELEMENT)),n=e.target.closest("."+g.CLASSNAME.NICK_ELEMENT).querySelector(".verified")?e.target.closest("."+g.CLASSNAME.NICK_ELEMENT).querySelector(`.${g.CLASSNAME.NICK_VERIFIED_BADGE} + a`).href:e.target.closest("."+g.CLASSNAME.NICK_ELEMENT).querySelector("a + a").href,a=e.target.closest(".wblock").querySelector(".text p").innerHTML,i=e.target.closest(".wblock").querySelector(".text .media-content a")?e.target.closest(".wblock").querySelector(".text .media-content a").href:null;e.target.classList.add(g.CLASSNAME.MARK_BUTTON_CLICKED),e.target.innerText="✔",o(t,n,a,i),setTimeout(()=>{e.target.remove()},700),setTimeout(()=>{M()},780)})(e),t.classList.contains("affect")&&t.closest(".more")&&setTimeout(()=>{N()},500),t.classList.contains(g.CLASSNAME.BADGE)){const e=t.dataset.whusername;O(g.DYNAMIC.DATASET.USERNAME(e))}}),document.getElementById(g.ID.VOTES_CONTAINER)&&document.getElementById(g.ID.VOTES_CONTAINER).closest(".rbl-block").querySelector(".nav").addEventListener("click",e=>{const t=e.target;t.classList.contains(g.CLASSNAME.MARK_ALL_BUTTON)&&((()=>{const e=window.location.href,t=s(`#${g.ID.VOTES_CONTAINER} .${g.CLASSNAME.VOTES_USERCARD}`);let n;r("#voters").closest("li").classList.contains("active")?n="wykop":r("#votersBury").closest("li").classList.contains("active")&&(n="zakop"),t.forEach(t=>{const a=r("a",t).title;o(a,e,(e=>`Użytkownik ${e}ał podlinkowane znalezisko.`)(n))}),setTimeout(()=>{M()},780)})(),r("."+g.CLASSNAME.MARK_ALL_BUTTON).innerText="Zrobione :)",setTimeout(()=>{r("."+g.CLASSNAME.MARK_ALL_BUTTON_ELEMENT).style.display="none",r("."+g.CLASSNAME.MARK_ALL_BUTTON).innerText="Oznacz wszystkich poniżej"},500)),(t.closest("#voters")||t.closest("#votersBury"))&&(r("."+g.CLASSNAME.MARK_ALL_BUTTON_ELEMENT).style.display="block")})},y=["alternews.pl","alexjones.pl","dziennik-polityczny.com","koniec-swiata.org","magnapolonia.org","narodowcy.net","nczas.com","mysl.pl","ndie.pl","neon24.pl","newsweb.pl","parezja.pl","prostozmostu24.pl","prawdaobiektywna.pl","reporters.pl","sioe.pl","wmeritum.pl","wolnosc24.pl","wolna-polska.pl","wprawo.pl","wsensie.pl","zmianynaziemi.pl","sputniknews.com","rt.com","ruptly.tv","prawica.net","xportal.pl","kresy.pl","bdp.xportal.pl","geopolityka.org","pravda.ru","voiceofrussia.com","ria.ru","ligakobietpolskich.pl","ronik.org.pl","obserwatorpolityczny.pl","mysl-polska.pl"].map(e=>["https://"+e,"https://www."+e,"http://"+e,"http://www."+e]).flat(),k=()=>{const e=()=>{if(!r(S.DOMAIN_CHECKER.SELECTOR.THREAD_LINK).href)return;const e=r(S.DOMAIN_CHECKER.SELECTOR.THREAD_LINK).href,t=new URL(e),n=t.protocol+"//"+t.hostname,a=((e,t="alert")=>`\n  <div class="${S.DOMAIN_CHECKER.CLASSNAME.WYKOP_ITEM_ANNOTATION} type-${t} space clearfix">\n\t\t<p>${e}</p>\n\t</div>\n`)("Uważaj! Źródło tego znaleziska jest podejrzewane o szerzenie rosyjskiej propagandy.");y.includes(n)&&r("."+S.DOMAIN_CHECKER.CLASSNAME.WYKOP_ITEM_INTRO).insertAdjacentHTML("beforebegin",a)};u("settings").GENERAL.WARN_ON_SUSPECTED_RUSSIAN_PROPAGANDA&&e()},C=()=>{u("settings").BADGE.HIDE_MARKED_USERS&&s("."+S.BADGE.CLASSNAME.BADGE).forEach(e=>{e.closest(".wblock").innerHTML='<p style="opacity:0.3">Tu był komentarz użytkownika, którego oznaczyłeś z pomocą WykopHelpera. Jeśli chcesz widzieć takie komentarze, edytuj swoje ustawienia w localStorage (bo zapewne tam aktywowałeś to ustawienie, czyż nie? :) ).</p>'})},{SETTINGS:{CLASSNAME:D}}=S,R={settingsMarkup:`\n<fieldset>\n  <h4>WykopHelper - Ustawienia</h4>\n\x3c!-- GENERAL --\x3e\n  <div class="space ${D.SETTINGS_GENERAL}">\n    <div class="row">\n      <input\n        class="checkbox"\n        type="checkbox"\n        category="GENERAL"\n        name="WARN_ON_RELOAD"\n        id="warnOnReload"\n      />\n      <label class="inline" for="warnOnReload">Ostrzegaj przy próbie zamknięcia/przeładowania strony gdy wykryto pisanie komentarza </label><span id="warnOnReloadInfo" style="cursor:pointer;border:1px solid currentcolor;padding:0 .5rem">ℹ</span>\n    </div>\n    <div class="row">\n      <input\n        class="checkbox"\n        type="checkbox"\n        category="GENERAL"\n        name="WARN_ON_SUSPECTED_RUSSIAN_PROPAGANDA"\n        id="warnOnRussian"\n      />\n      <label class="inline" for="warnOnRussian">Oznaczaj znaleziska ze źródeł podejrzewanych o szerzenie Rosyjskiej propagandy </label><span id="russianPropagandaInfo" style="cursor:pointer;border:1px solid currentcolor;padding:0 .5rem">ℹ</span>\n    </div>\n  </div>\n\x3c!--  BADGE --\x3e\n  <div class="space ${D.SETTINGS_BADGE}">\n    <div class="row">\n      <input\n        class="checkbox"\n        type="checkbox"\n        category="BADGE"\n        name="HIDE_MARKED_USERS"\n        id="hideMarkedUser"\n        disabled\n      />\n      <label title="Ficzer w trakcie prac koncepcyjnych :)" class="inline settings__crossed" for="hideMarkedUser">Ukrywaj treści oznakowanych użytkowników</label>\n    </div>\n    <div class="row space">\n      <input placeholder="Domyślny tekst odznaki" id="badgeDefaultValue" category="BADGE" value="" name="DEFAULT_NAME" type="text">\n      <small>Domyślny tekst odznaki</small>\n    </div>\n  </div>\n\x3c!-- SPECIAL --\x3e\n  <div class="space ${D.SETTINGS_SPECIAL}">\n    <div class="row">\n      <small>Jeśli chcesz wyczyścić listę oznaczonych wcześniej użytkowników, możesz to zrobić poniżej. W związku z tym, że jest to akcja nieodwracalna, musisz najpierw potwierdzić, że na pewno taki jest Twój cel. Uwaga - po kliknięciu przycisku akcja wykonywana jest natychmiast, bez dodatkowych potwierdzeń!</small>\n    </div>\n    <div class="row">\n      <input\n        class="checkbox"\n        type="checkbox"\n        category="SPECIAL"\n        name="ALLOW_WIPE_MARKED_LIST"\n        id="allowWipeAllMarked"\n      />\n      <label class="inline" for="allowWipeAllMarked">Zaznacz by odblokować możliwość wyczyszczenia listy</label>\n    </div>\n    <div class="row space">\n      <button style="opacity:0.4" id="whsettings__remove-all-marked" disabled>Wyczyść</button>\n    </div>\n    <div class="row space">\n      <button class="button" id="showAllMarked">Pokaż wszystkich oznaczonych użytkowników</button>\n    </div>\n  </div>\n</fieldset>\n`,settingsUserTable:`\n<div class="${D.WH_USER_TABLE_CONTAINER} ${D.WH_USER_TABLE_CONTAINER_HIDDEN}">\n  <h4 class="${D.WH_USER_TABLE_HEADING}">WykopHelper - Lista oznaczonych użytkowników</h4>\n  <table class="${D.WH_USER_TABLE}">\n    <thead class="${D.WH_USER_TABLE_HEAD}">\n      <tr>\n        <td>no.</td>\n        <td>Nick</td>\n        <td>Typ</td>\n        <td>Link</td>\n        <td>Usuń</td>\n      </tr>\n    </thead>\n    <tbody class="${D.WH_USER_TABLE_BODY}">\n    </tbody>\n  </table> \n</div>\n`,settingsNav:`<li class="${D.SETTINGS_NAV}"><a href="https://www.wykop.pl/ustawienia/wykophelper/"><span><strong>WykopHelper</strong> &#10024;</span></a></li>`,settingsUserTableRow:(e,t,n)=>`\n<tr class="${D.WH_USER_TABLE_ROW}">\n  <td></td>\n  <td><a href="https://www.wykop.pl/ludzie/${e}" target="_blank">${e}</a></td>\n  <td>${t}</td>\n  <td><a href="${n}" target="_blank">&#128279</a></td>\n  <td><span class="${D.WH_USER_TABLE_REMOVE_BUTTON}" data-whuserremove="${e}">&#x02717;</a></td>\n</tr>\n`,textContent:{SHOW_ALL_MARKED:"Pokaż wszystkich oznaczonych użytkowników",HIDE_TABLE:"Schowaj tabelę",RUSSIAN_PROPAGANDA_MODAL_TITLE:"Skąd lista stron z propagandą?",WARN_ON_RELOAD_MODAL_TITLE:"Ostrożnie z tym ficzerem... :("}},{SETTINGS:z}=S,b=()=>{const e=u("settings"),t=u(),n=u("unique"),a=r(z.SELECTOR.SETTINGS_FORM_ELEMENT),o=()=>{r(z.SELECTOR.ACTIVE_NAV_ELEMENT).classList.remove("active"),r("."+z.CLASSNAME.WH_NAV_SETTINGS_LINK).classList.add("active"),a.innerHTML="",a.innerHTML=R.settingsMarkup,a.removeAttribute("method"),a.removeAttribute("action"),a.insertAdjacentHTML("afterend",R.settingsUserTable),(()=>{const n=r("."+z.CLASSNAME.WH_USER_TABLE_BODY);t.forEach(t=>{n.insertAdjacentHTML("beforeend",R.settingsUserTableRow(t.nick,t.label||e.BADGE.DEFAULT_NAME,t.link))})})(),s("input").forEach(t=>{const n=t.getAttribute("category");t.id!==z.ID.ALLOW_WIPE_MARKED_LIST&&"checkbox"===t.type?t.checked=e[n][t.name]:"text"===t.type&&"nsQ"!==t.name&&(t.value=e[n][t.name])})},i=()=>{a.addEventListener("change",t=>{const n=t.target.getAttribute("category"),a=t.target.name;"checkbox"===t.target.type&&t.target.id!==z.ID.ALLOW_WIPE_MARKED_LIST&&(e[n][a]=!e[n][a],localStorage.setItem(c,JSON.stringify(e)))},{passive:!0}),a.addEventListener("click",e=>{e.target.id===z.ID.SHOW_MARKED_TABLE&&(e.preventDefault(),r("."+z.CLASSNAME.WH_USER_TABLE_CONTAINER).classList.toggle(z.CLASSNAME.WH_USER_TABLE_CONTAINER+"--hidden"),r(`.${z.CLASSNAME.WH_USER_TABLE_CONTAINER}--hidden`)?document.getElementById(z.ID.SHOW_MARKED_TABLE).textContent=R.textContent.SHOW_ALL_MARKED:document.getElementById(z.ID.SHOW_MARKED_TABLE).textContent=R.textContent.HIDE_TABLE),e.target.id===z.ID.ALLOW_WIPE_MARKED_LIST&&(e.target.disabled=!0,document.getElementById(z.ID.REMOVE_ALL_MARKED).disabled=!1,document.getElementById(z.ID.REMOVE_ALL_MARKED).style.opacity=1),e.target.id===z.ID.REMOVE_ALL_MARKED&&(e.preventDefault(),localStorage.setItem(A,"[]"),localStorage.setItem(E,"[]"),location.reload()),e.target.id===z.ID.RUSSIAN_PROPAGANDA_INFO_LINK&&Swal.fire({title:R.textContent.RUSSIAN_PROPAGANDA_MODAL_TITLE,html:N,icon:"info",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"OK",width:"80%"}),e.target.id===z.ID.WARN_ON_RELOAD_INFO_LINK&&Swal.fire({title:R.textContent.WARN_ON_RELOAD_MODAL_TITLE,html:'\n  <p>Ten ficzer jest eksperymentalny. Z nie do końca dla mnie zrozumiałych powodów (podejrzewam, że przeszkadza tu jakiś wykopowy skrypt reklamowy), na niektórych przeglądarkach (np. firefox z ublockiem) działa jak powinien, a na innych (czysty Chrome) nie działa w ogóle. Dlatego zanim zdecydujesz się mu zaufać, przeprowadź kilka testów. Ostrzeżenie powinno aktywować się, gdy w okienku pisania komentarza znajdować się będzie 6 słów i więcej.\n  <p style="margin-top:.5rem">W najbliższej przyszłości poświęcę nieco więcej czasu na debugging i, mam nadzieję, odkryję przyczynę tej niestabilności. Sorry za utrudnienia, ale to wciąż wersja beta ;)\n',icon:"info",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"OK",width:"80%"})},{passive:!1}),a.addEventListener("keyup",t=>{const n=t.target.getAttribute("category"),a=t.target.name;"text"===t.target.type&&(e[n][a]=t.target.value.toLowerCase(),localStorage.setItem(c,JSON.stringify(e)))},{passive:!0})};p(d.settings),p(d.modal),o(),i(),r("."+S.SETTINGS.CLASSNAME.WH_USER_TABLE).addEventListener("click",e=>{const a=e.target;a.classList.contains(""+S.SETTINGS.CLASSNAME.WH_USER_TABLE_REMOVE_BUTTON)&&((e=>{for(let[n,a]of t.entries())if(a.nick===e){delete t[n];const e=t.filter(e=>null!=e);localStorage.setItem(E,JSON.stringify(e))}const a=n.filter(t=>t!==e);localStorage.setItem(A,JSON.stringify(a))})(a.dataset.whuserremove),a.closest("tr").remove())})},h="WykopHelper zainstalowany!",f='Miłego używania dodatku! Jeśli masz jakiekolwiek problemy, pytania lub sugestie, zgłoś je <a href="https://github.com/PLWpl/WykopHelper/issues" target="_blank">tutaj.</a>',B="Super!",H={title:"WykopHelper zaktualizowany!",content:`\nDodatek WykopHelper został właśnie zaktualizowany do wersji 0.53. Wprowadzone zmiany to: <br>\n<ul class="${S.MODAL.CLASSNAME.LIST}">\n  <li class="${S.MODAL.CLASSNAME.LIST_ITEM}">\n    Dodano możliwość zmiany tekstu na odznace każdego użytkownika z osobna. By zmienić tekst wystarczy kliknąć na odznace przy danym userze, odszukać nowe pole tekstowe i wpisać tam, co dusza zapragnie :)\n  </li>\n</ul>\n`,button:"Okej!"},U=`<span class="${S.COMMON.CLASSNAME.BUTTON} ${S.HIGHLIGHT_OP.CLASSNAME.HIGHLIGHT_BUTTON}">Pokaż OPa</span>`,{BADGE:G}=S,W=()=>{u("settings").GENERAL.WARN_ON_RELOAD&&window.addEventListener("unload",e=>{(()=>{const e=r(G.SELECTOR.REPLY_FORM),t=r(G.SELECTOR.COMMENT_FORM),n=e&&e.value.split(" ").length>5,a=t&&t.value.split(" ").length>5;return!n&&!a})()||e.preventDefault()})},v=()=>{u("settings").GENERAL.WARN_ON_SUSPECTED_RUSSIAN_PROPAGANDA&&(r("."+S.COMMON.CLASSNAME.WOODLE).style.display="none")};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},p(d.modal,"whInitModalStyle"),localStorage.getItem("WHupdate")&&localStorage.getItem("WHupdate")<"0.53"?(Swal.fire({title:H.title,html:H.content,icon:"info",width:"80%",confirmButtonText:H.button}),localStorage.setItem("WHupdate","0.53"),(()=>{let e;e=localStorage.getItem(E)?u("marked"):[],e.forEach(e=>{e.label||(e.label=""),e.content||(e.content="Niestety, użytkownik został oznaczony PRZED uaktywnieniem funkcji zapisywania treści komentarzy. Jeśli chcesz by pojawiła się tu jego treść, przejdź do podlinkowanego niżej komentarza, a następnie usuń oznaczenie i dodaj je ponownie.")}),localStorage.setItem(E,JSON.stringify(e))})()):localStorage.getItem("WHupdate")||(Swal.fire({title:h,html:f,icon:"warning",width:"80%",confirmButtonText:B}),localStorage.setItem("WHupdate","0.53")),I(),t()&&v(),n()&&(w(),W(),document.addEventListener("paste",e=>{if(r("."+S.EMBED.CLASSNAME.EMBED_FILE)&&e.clipboardData.files[0]){const t=r(`.${S.EMBED.CLASSNAME.EMBED_FILE} input`);t.files=e.clipboardData.files;const n=new Event("UIEvent");n.initEvent("change",!1,!0),t.dispatchEvent(n)}},{passive:!0}),C()),a()&&r(z.SELECTOR.LAST_NAV_ELEMENT).insertAdjacentHTML("beforeend",R.settingsNav),o()&&b(),i()&&k(),l()&&(r(`${S.HIGHLIGHT_OP.SELECTOR.OP_THREAD} .${S.BADGE.CLASSNAME.NICK_ELEMENT}`).insertAdjacentHTML("afterbegin",U),r("."+S.HIGHLIGHT_OP.CLASSNAME.HIGHLIGHT_BUTTON).addEventListener("click",()=>{const e=r(".night")?"rgb(7, 68, 91)":"#ffeac1";s("."+S.HIGHLIGHT_OP.CLASSNAME.AUTHOR_COMMENTS).forEach(t=>{t.style.backgroundColor=e}),r("."+S.HIGHLIGHT_OP.CLASSNAME.HIGHLIGHT_BUTTON).remove()}))}();
